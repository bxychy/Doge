<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>promise</title>
		<style>
			.ball{width:50px;height:50px;border-radius:50%;}
			.ball1{background:red;}
			.ball2{background:yellow;}
			.ball3{background:green;}
		</style>
	</head>
	<body>
		<div class="ball ball1"></div>
		<div class="ball ball2"></div>
		<div class="ball ball3"></div>
	</body>
	<script>
		var ball1=document.querySelector('.ball1');
		var ball2=document.querySelector('.ball2');
		var ball3=document.querySelector('.ball3');
		
		function anmite(ball,distance,cb){
			setTimeout(function(){
				var marg=parseInt(ball.style.marginLeft,10);
				if(marg===distance){
					cb&&cb();
				}else{
					if(marg<distance){
						marg++;
					}else{
						marg--;
					}
					ball.style.marginLeft=marg+'px';
					anmite(ball,distance,cb);
				}
			},13);
		}
		console.log('39',ball1,ball2,ball3);
		anmite(ball1,100,function(){
			console.log('41',ball1,ball2,ball3);
			anmite(ball2,200,function(){
				anmite(ball3,300,function(){
					anmite(ball3,50,function(){
						anmite(ball2,150,function(){
							anmite(ball1,150,function(){
					console.log('46');
							});
						});
					});
				});
			});
		});
	</script>
</html>
